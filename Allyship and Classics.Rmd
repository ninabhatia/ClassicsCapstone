---
title: "Capstone"
output: html_notebook
---

#--

#INTRODUCTION 

The survey was officially closed on April 30 2021 at 6:00pm as such all analysis was only done with responses that had been finished prior to that time. It is important that this date differs from the termination given in survey to ensure that respondents had time to finish any in progress response. 

The raw data csv file was created by Qualtrics. One file was created: DataTxt.csv. It contains all the recorded responses and lists the responses in terms of the answer text. It is unclear how Qualtrics differentiates between "Responses in Progress" and "Recorded Responses" given that the "Recorded Responses" data contained responses that were not finished. Those unfinished recorded responses were separated from the finished recorded responses as described below. 


```{r}
#Some useful packages 
library(dplyr)
library(data.table)
library(xlsx)

#Set Working Directory 
setwd("~/Downloads/Capstone Data")
```

The raw data were read into the working directory, incomplete responses were filtered into their own data set (txtU), and the following columns generated by Qualtrics were removed: Start Date, End Date, Status, Duration, Finished, Recorded Date, Responded, Distribution Channel, and User Language. 


```{r}
#Uploading and cleaning data 
rawTxt <- as.data.frame(fread("DataTxt.csv"))

#Creating finished and unfinished data sets 
txtF<- rawTxt[!(rawTxt$Finished == "False"), ]
txtU <- rawTxt[(rawTxt$Finished == "False"), ]

#Removing unnecessary  columns 
txtF <- txtF[ -c(1,2),-c(1:10) ]
row.names(txtF) <- 1:nrow(txtF)
txtU <- txtU[ ,-c(1:10) ]
row.names(txtU) <- 1:nrow(txtU)


#Removing international responses from txtF 
txtF <- txtF[ -c(68, 77, 80, 104, 112, 117, 120, 121),  ]
```



```{r}
#Downloading separated data 
write.csv(txtF, 
          "FinishedData.csv",row.names = FALSE)
write.csv(txtU, 
          "UnFinishedData.csv",row.names = FALSE)
```

The analysis was done only for the finished survey data (txtF). However both data sets were saved so that they could be examined later if nesseccary. 

#---

#ORGANIZATION OF FINISHED RESPONSES 

Since this study is primarily anecdotal the goal of the following code is to organize the finished responses in a neat way so that they can be exported to Excel and easily read. Furthermore any graphing of the results or calculations done with them are simple enough to be carried out in Excel once the data is organized.

```{r}
#Wrote function so that the frequency for each response is listed in one data frame
freq <- function(df){
  val <- data.frame()
  dfname <- as.data.frame(colnames(df))
  for(i in 1:ncol(df)){
    it <- as.data.frame(table(df[,c(i)]))
    names(it) <- c(dfname[i,], "frq")
    val <- merge(val, it, by = 0, all=TRUE)
    val[ order(val[,1]), 1:2]
    val <- val[,-c(1)]
    i <- i+1
  }
  return(val)
}
```


#DEMOGRAPHICS 

The survey contained 10 demographic questions. First the demographic data was sectioned from the overall finished data set and labeled for ease of analysis.

```{r}
#Sectioning 
DemF<- txtF[, c(1:8)]

#Labeling
Labels <-  c('University' , 'Age' , 'Gender', 'GenderText', 'Race', 'RaceText', 'Status', 'StatusText') 
names(DemF)<- Labels

#Checking out data 
FU <- as.data.frame(table(DemF$University))
```


```{r}
#Exporting DemF for manual cleaning 
write.csv(DemF, 
          "DemF.csv",row.names = FALSE)
```

The DemF.csv file was manually cleaned in Excel so that the self reported data could be represented in format that allows for easier analysis. 

The university names were standardized to account for the to account for different spellings of university names and all blank responses were listed as 'Prefer Not To Say'. The race and gender categories were made to include self reported dated for example if a respondents select 'Multiracial or Multiethinic' and self reported their identity as 'x', their response was listed as 'Multiracial or Multiethnic-x'. Similarly, for those who self reported their gender as 'x', their gender was listed as 'x'. 

Note that those who responded "tenured faculty" to the status question were assigned the status "tenured track faculty"

```{r}
#Reading in cleaned demF data 
DemF <- as.data.frame(read.csv("DemF.csv"))
```

The DemF.csv file was then read back into the environment and replaced the original DemF data frame.

```{r} 
#Applying frequency function over DemF 
DemFFrq <-  freq(DemF)

#Labeling
Labels <- c('University Categories', 'University' , 
            'Age Categories' , 'Age', 
            'Gender Categories', 'Gender', 
            'Race Categories', 'Race', 
            'Status Categories', 'Status')
names(DemFFrq) <- Labels

#Writing over TxtF with cleaned demographic data 
txtF[, c(1,3,5,7)] <- DemF[, c(1,3,5,6)]
```




#PERSONAL EXPERIENCES 

The data concerning personal experiences was be sectioned from the overall finished data set, labeled, and then exported for manual cleaning.  
```{r}
#Sectioning 
PerExpF<- txtF[, c(9:29)]

#Labeling
Labels <- c("Relevence of Antiracism to Classics", "Relevance Comments", 
            "Sense of Belonging" , "Sense of Belonging Comments",
            "Experience of Interpersonal Racism", "Experiences of IR Comments",
            "Experience IR Intervention", "Experience IR Intervention Comments", 
            "Experience of Structural/Institutional Racism", "Experience of SIR Comments",
            "Experience SIR Intervention", "Experience SIR Intervention Comments",
            "Witnessing Interpersonal Racism", "Witnessing IR Comments",
            "Witnessing IR Intervention", "Witnessing IR Intervention Comments",
            "Witnessing Structural/Institutional Racism", "Witnessing SIR Comments", 
            "WitnessingSIR Intervention", "Witnessing SIR Intervention Comments", 
            "Final Comments"
            )
names(PerExpF) <- Labels
```

```{r}
#Exporting PerExpF for manual cleaning 
write.csv(PerExpF, 
          "PerExpF.csv",row.names = FALSE)
```
The PerExpF.csv file was manually cleaned in Excel so that the self reported data could be represented in format that allows for easier analysis. All self reported comments were read, interpreted accordingly, and separated from the data.

The comments regarding the relevance of antiracism to the Classics contained no information that would impact to the respondent's answer or skew analysis of the respondents answers. As such it was separated from the data. Blanks in this column were filled in as 'Prefer Not To Say'. 

This was also the case for the majority of comments regarding sense of belonging in the Classics except >10 respondents opted to leave the multiple choice blank and self describe their feelings regarding sense of belonging. In order to not misrepresent these deeply personal experiences those who left the answer blank and only self reported were listed as 'Self Reported'. 

Given that  white people can not experience racism, regardless of answer choice those who specified they were white in the comments to the questions on experience of interpersonal racism  and structural racism were marked as not having experienced racism. This of course is not to say white folx cannot experience sexism, classism, antisemitism, homophobia, or any other form of discrimination. The goal of this study is to understand racism and antiracism in the Classics.The answers to these questions were NOT cross referenced with respondents' races because race categories are often ambiguous for Latinx individuals and other people of color who might feel compelled to identify as white for various reasons. While more intersections studies should certainly be done- this study is deliberately narrow in its scope. All blanks were filled with 'Prefer Not to Say'.

With regards to interventions for experience of interpersonal racism and structural racism, the self-reported comments were all read, deemed to contain no information that would impact to the respondent's answer or skew analysis of the respondents answers.

With regards with witnessing interpersonal racism and/or structural racism those who selected 'No' or left the question blank and commented that they had heard of racists incidents occurring were marked as not having witnessed interpersonal racism. This was done in order to reflect the language of the questions as the question specified witnessing as opposed to hearing about racist incidents. 

With regards to interventions for witnessing interpersonal racism and structural racism, the self-reported comments were all read, deemed to contain no information that would impact to the respondent's answer or skew analysis of the respondents answers.

The PerExpF.csv file was then read back into the environment and replaced the original PerExpF data frame.

```{r}
#Reading in cleaned PerExpF data 
PerExpF <- as.data.frame(read.csv("PerExpF.csv"))

```

```{r}
#Applying frequency function over PerExpF
PerExpFFrq <- freq(PerExpF)
Labels <- c("Relevance Categories","Relevence of Antiracism to Classics", 
            "Belonging Categories", "Sense of Belonging" , 
            "EIR Categories", "Experience of Interpersonal Racism",
            "EIR Int Categories","Experience IR Intervention",
            "ESIR Categories", "Experience of Structural/Institutional Racism",
            "ESIR Int Categories", "Experience SIR Intervention",
            "WIR Categories", "Witnessing Interpersonal Racism",
            "WIR Int Categories","Witnessing IR Intervention", 
            "WSIR Categories", "Witnessing Structural/Institutional Racism", 
            "WSIR Int Categories", "Witnessing SIR Intervention"
            )
names(PerExpFFrq) <- Labels
#Writing over TxtF with cleaned personal experience data 
txtF[, c(13,15,17,19,21,23,27,29)] <- PerExpF[, c(3:10)]
```

The responses of people who had either said yes to experiencing or witnessing racism were separated out.
```{r}
#Separating out experience of racism 

EIR <- PerExpF[(PerExpF$Experience.of.Interpersonal.Racism == "Yes"), ] #Experiences of interpersonal racism
ESIR <- PerExpF[(PerExpF$Experience.of.Structural.Institutional.Racism == "Yes"), ] #Experiences of structural/institutional racism 
EB <- EIR[(EIR$Experience.of.Structural.Institutional.Racism == "Yes"), ] #Experience of both 


WIR <- PerExpF[(PerExpF$Witnessing.Interpersonal.Racism == "Yes"), ] #Witnesses of interpersonal racism  
WSIR <- PerExpF[(PerExpF$Witnessing.Structural.Institutional.Racism == "Yes"), ] #Witnesses of structural/institutional racism 
WB <- WIR[(WIR$Witnessing.Structural.Institutional.Racism == "Yes"), ]
```

#CURRENT DIVERSITY, EQUITY, AND INCLUSION PROGRAMS/POLICIES

This data was sectioned from the overall finished data set and labeled. 

```{r}
#Sectioning 
CDEIF <- txtF[, c(30:79)]



#Labeling 
Labels <- c("University Wide Y/N", "Classics Department Y/N", "Training", "Solidarity Comments",
            "Number of UDEI",
            "UDecsribe 1", "UCat 1", "UEffect 1", "URate 1",
            "UDecsribe 2", "UCat 2", "UEffect 2", "URate 2",
            "UDecsribe 3", "UCat 3", "UEffect 3", "URate 3",
            "UDecsribe 4", "UCat 4", "Ueffect 4", "URate 4",
            "UDecsribe 5", "UCat 5", "UEffect 5", "URate 5",
            "Training Name", "Traing Context", "Training Context Text", "Training Impact",
            "Number of CDEI", 
            "CDescribe 1", "CCat 1", "CEffect 1", "CComment 1",
            "CDescribe 2", "CCat 2", "CEffect 2", "CComment 2",
            "CDescribe 3", "CCat 3", "CEffect 3", "CComment 3",
            "CDescribe 4", "CCat 4", "CEffect 4", "CComment 4", 
            "CDescribe 5", "CCat 5", "CEffect 5", "CComment 5"
            )
names(CDEIF) <- Labels 
```

The data regarding the diversity, equity, and inclusion training was sectioned into its own data set and all the blank rows were removed.

```{r}
#Sectioning out training data 
Training <- CDEIF[, c(26:29)]
CDEIF <- CDEIF[, -c(26:29)]
```

```{r}
#Removing blank rows from training data 
Training <- Training[!apply(Training == "", 1, all),]
```

The data that were the answers to general questions about diversity, equity, and inclusion programs was sectioned out. 

```{r}
#Sectioning out training data 
GeneralDEI <- CDEIF[, c(1:3,5,26,4)]
CDEIF <- CDEIF[, -c(1:3,5,26,4)]
```

The response frequencies were then calculated for all the data except those responding to the question "How, if at all, does your Classics Department address racism and foster solidarity with people of color?". 

```{r}
#Applying frequency function over GeneralDEI
GDEIFFrq <- freq(GeneralDEI[,-c(6)])
```


#FUTURE DIVERSITY, EQUITY, AND INCLUSION PROGRAMS/POLICIES

This data was sectioned from the overall finished data set, labeled, and downloaded as csv for manual cleaning. 
```{r}
#Sectioning 
FDEIF <- txtF[ ,c(80:98)]

#Labeling 
Labels  <- c( "Allyship Plans", 
              "DEI Commmitte Implementation", "Webpage Implementation", "Dialogue Implementation",
              "Syllabi Implementation", "Speaker Implementation", "Community Outreach Implementation",
              "DEI Commmitte Effective", "Webpage Effectice", "Dialogue Effective",
              "Syllabi  Effective", "Speaker Effectice", "Community Outreach Effectice", 
              "Ideas", "Faculty Prohibitive Factors", "Falculty Comments", 
              "Student Prohibitive Factors", "Student Comments",
              "Final Thoughts"
              )
names(FDEIF) <- Labels

#Exporting FDEIF for manual cleaning 
write.csv(FDEIF, 
          "FDEIF.csv",row.names = FALSE)
```

The frequencies for the potential diversity, equity and inclusion data were calculated.
```{r}
idea <- FDEIF[,c(2:13)]
ideaf <- freq(idea)
```
#EXPORTING ALL THE DATA

In addition to calculating the frequency of each response to the demographic data, the responses to the sense of belonging question from non white individuals filtered into their own data frame. 
```{r}
#Sectioning 
POCRes <- txtF[!(txtF$Q11 == "White"), ]

#Labeling 
Labels <- c("University" , "Age", "Gender", "GenderText", "Race", "RaceText", "Status", "StatusText",
            "Relevence of Antiracism to Classics", "Relevance Comments", 
            "Sense of Belonging" , "Sense of Belonging Comments",
            "Experience of Interpersonal Racism", "Experiences of IR Comments",
            "Experience IR Intervention", "Experience IR Intervention Comments", 
            "Experience of Structural/Institutional Racism", "Experience of SIR Comments",
            "Experience SIR Intervention", "Experience SIR Intervention Comments",
            "Witnessing Interpersonal Racism", "Witnessing IR Comments",
            "Witnessing IR Intervention", "Witnessing IR Intervention Comments",
            "Witnessing Structural/Institutional Racism", "Witnessing SIR Comments", 
            "WitnessingSIR Intervention", "Witnessing SIR Intervention Comments", 
            "Final Comments",
            "University Wide Y/N", "Classics Department Y/N", "Training", "Solidarity Comments",
            "Number of UDEI",
            "UDecsribe 1", "UCat 1", "UEffect 1", "URate 1",
            "UDecsribe 2", "UCat 2", "UEffect 2", "URate 2",
            "UDecsribe 3", "UCat 3", "UEffect 3", "URate 3",
            "UDecsribe 4", "UCat 4", "Ueffect 4", "URate 4",
            "UDecsribe 5", "UCat 5", "UEffect 5", "URate 5",
            "Training Name", "Traing Context", "Training Context Text", "Training Impact",
            "Number of CDEI", 
            "CDescribe 1", "CCat 1", "CEffect 1", "CComment 1",
            "CDescribe 2", "CCat 2", "CEffect 2", "CComment 2",
            "CDescribe 3", "CCat 3", "CEffect 3", "CComment 3",
            "CDescribe 4", "CCat 4", "CEffect 4", "CComment 4", 
            "CDescribe 5", "CCat 5", "CEffect 5", "CComment 5",
            "Allyship Plans", 
              "DEI Commmitte Implementation", "Webpage Implementation", "Dialogue Implementation",
              "Syllabi Implementation", "Speaker Implementation", "Community Outreach Implementation",
              "DEI Commmitte Effective", "Webpage Effectice", "Dialogue Effective",
              "Syllabi  Effective", "Speaker Effectice", "Community Outreach Effectice", 
              "Ideas", "Faculty Prohibitive Factors", "Falculty Comments", 
              "Student Prohibitive Factors", "Student Comments",
              "Final Thoughts"
            )

names(POCRes) <- Labels

```


```{r}
write.xlsx(txtF, file="DataSummary.xlsx", sheetName="Finished Responses", append = FALSE)
write.xlsx(POCRes, file="DataSummary.xlsx", sheetName="POC Responses", append = TRUE)
write.xlsx(DemFFrq, file="DataSummary.xlsx", sheetName="Demographics", append = TRUE)
write.xlsx(PerExpFFrq, file="DataSummary.xlsx", sheetName="Personal Experiences", append = TRUE)

write.xlsx(EIR, file="DataSummary.xlsx", sheetName="Experiencing Personally Mediated Racism", append = TRUE)
write.xlsx(ESIR, file="DataSummary.xlsx", sheetName="Experiencing Structural Racism", append = TRUE)
write.xlsx(EB, file="DataSummary.xlsx", sheetName="Experiencing Racism", append = TRUE)

write.xlsx(WIR, file="DataSummary.xlsx", sheetName="Witnessing Personally Mediated Racism", append = TRUE)
write.xlsx(WSIR, file="DataSummary.xlsx", sheetName="Witnessing Structural Racism", append = TRUE)
write.xlsx(WB, file="DataSummary.xlsx", sheetName="Witnessing Racism", append = TRUE)

write.xlsx(GDEIFFrq, file="DataSummary.xlsx", sheetName="General Current DEI", append = TRUE)
write.xlsx(Training, file="DataSummary.xlsx", sheetName="Training", append = TRUE)
write.xlsx(CDEIF, file="DataSummary.xlsx", sheetName="Specific Current DEI", append = TRUE)
write.xlsx(ideaf, file="DataSummary.xlsx", sheetName="Suggestions", append = TRUE)
```

```{r}
#separating out white versus poc responses to questions about relevance and sense of belonging 
yt <- txtF[(txtF$Q11 == "White"), ]
poc <- txtF[!(txtF$Q11 == "White"), ]


pocr <- freq(poc)
ytr <- freq(yt)

write.xlsx(pocr, file = "ResponsesByRace.xlsx", sheetName = "POCR", append = FALSE)
write.xlsx(ytr, file = "ResponsesByRace.xlsx", sheetName = "ytr", append = TRUE )
```

